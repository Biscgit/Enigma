stages:
  - prebuild
  - build
  - test

include: "ci-templates.yml"

build-flutter-builder:
  stage: prebuild
  extends: .build-docker
  variables:
    DOCKERPATH: ".docker-builds/flutter"
    NAME: "/flutter-builder"
      # rules:
      #- if: "$NIGHTLY_BUILD"

build-backend:
  stage: build
  extends: .build-docker
  variables:
    DOCKERPATH: "backend"

build-frontend:
  stage: build
  extends: .build-docker
  variables:
    DOCKERPATH: "frontend"

build-scanner:
  stage: build
  extends: .build-docker
  variables:
    DOCKERPATH: ".docker-builds/scanner"
    NAME: "/scanner"
      #  rules:
      #    - if: "$NIGHTLY_BUILD"

scan-backend:
  extends: .scan_image
  variables:
    DOCKERPATH: "backend"

scan-frontend:
  extends: .scan_image
  variables:
    DOCKERPATH: "frontend"

unit-test-job:
  stage: test
  script:
    - echo "Running unit tests... This will take about 60 seconds."
    - sleep 60
    - echo "Code coverage is 90%"

lint-test-job:
  stage: test
  script:
    - echo "Linting code... This will take about 10 seconds."
    - sleep 10
    - echo "No lint issues found."
